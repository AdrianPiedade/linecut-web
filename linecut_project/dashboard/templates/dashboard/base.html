{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token }}">

    <title>{% block title %}LineCut Dashboard{% endblock %}</title>
    <link rel="icon" type="image/png" href="{% static 'dashboard/images/logo_linecut_title.png' %}">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css" rel="stylesheet">

    <link rel="stylesheet" href="{% static 'dashboard/css/base_styles.css' %}">

    {% block head_extra %}{% endblock %}
</head>
<body data-default-image="{% static 'dashboard/images/perfil_default.png' %}">
    <aside class="menu-lateral">
        <div class="logo">
            <img src="{% static 'dashboard/images/logo_linecut.png' %}" alt="LineCut Logo">
        </div>

        <div class="restaurant-info">
            <h3>{{ request.session.user_profile.nome_lanchonete|default:"Meu Restaurante" }}</h3>
            <button id="store-status-toggle"
                    class="status-loja-btn {% if request.session.user_profile.status == 'aberto' %}aberto{% else %}fechado{% endif %}"
                    data-status="{{ request.session.user_profile.status|default:'fechado' }}">
                <div class="status-indicator"></div>
                <span>Loja {% if request.session.user_profile.status == 'aberto' %}Aberta{% else %}Fechada{% endif %}</span>
            </button>
        </div>

        <nav class="menu-nav">
            <a href="{% url 'dashboard:index' %}" class="menu-item {% if request.resolver_match.url_name == 'index' %}selected{% endif %}">
                <i class="bi bi-house-door icon"></i>
                <span>Início</span>
            </a>
            <a href="{% url 'dashboard:pedidos' %}" id="menu-pedidos" class="menu-item {% if request.resolver_match.url_name == 'pedidos' or request.resolver_match.url_name == 'pedidos_view' %}selected{% endif %}">
                <i class="bi bi-receipt icon"></i>
                <span>Pedidos</span>
            </a>
            <a href="{% url 'dashboard:produtos' %}" class="menu-item {% if request.resolver_match.url_name == 'produtos' %}selected{% endif %}">
                <i class="bi bi-tags icon"></i>
                <span>Produtos</span>
            </a>
            <a href="{% url 'dashboard:estoque' %}" class="menu-item {% if request.resolver_match.url_name == 'estoque' %}selected{% endif %}">
                <i class="bi bi-box-seam icon"></i>
                <span>Estoque</span>
            </a>
            {% if request.session.user_profile.plano == 'premium' %}
                <a href="{% url 'dashboard:dashboard' %}" class="menu-item {% if request.resolver_match.url_name == 'dashboard' %}selected{% endif %}">
                    <i class="bi bi-speedometer icon"></i>
                    <span>Dashboard</span>
                </a>
            {% else %}
                <a class="menu-item disabled" title="Disponível apenas para plano Premium">
                    <i class="bi bi-speedometer icon"></i>
                    <span>Dashboard</span>
                    <i class="bi bi-lock lock-icon" style="font-size: 14px; opacity: 0.7;"></i>
                </a>
            {% endif %}
            <a href="{% url 'dashboard:avaliacoes' %}" class="menu-item {% if request.resolver_match.url_name == 'avaliacoes' %}selected{% endif %}">
                <i class="bi bi-star icon"></i>
                <span>Avaliações</span>
            </a>
            <a href="#" class="menu-item">
                <i class="bi bi-bell icon"></i>
                <span>Notificações</span>
            </a>
            <a href="{% url 'dashboard:configuracoes' %}" class="menu-item {% if request.resolver_match.url_name == 'configuracoes' %}selected{% endif %}">
                <i class="bi bi-gear icon"></i>
                <span>Configurações</span>
            </a>
        </nav>

        <div class="menu-sair">
             <a href="{% url 'dashboard:logout' %}" style="display: flex; align-items: center; text-decoration: none; color: inherit;">
                <i class="bi bi-box-arrow-right icon"></i>
                <span>Sair</span>
            </a>
        </div>
    </aside>

    <main class="conteudo-principal">
        {% block content %}
        {% endblock %}
    </main>

    <div id="toast-container" class="toast-container"></div>

    <script>
        const CSRF_TOKEN = "{{ csrf_token }}";
        var staticUrl = "{% static '' %}";
    </script>
    {% block scripts %}
    <script src="{% static 'dashboard/js/store_status.js' %}"></script>
    {% endblock %}
</body>
</html>
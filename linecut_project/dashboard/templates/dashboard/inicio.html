{% extends 'dashboard/base.html' %}
{% load static %}

{% block title %}LineCut - Dashboard Início{% endblock %}

{% block head_extra %}
    <link rel="stylesheet" href="{% static 'dashboard/css/inicio.css' %}">
{% endblock %}

{% block content %}
    <header class="cabecalho">
        <h1>Bem-vindo!</h1>
        <p>Olá, {{ request.session.user_profile.nome_lanchonete|default:"Usuário" }}! Aqui está o resumo do seu dia até agora</p>
    </header>

    <div class="info-cards">
        <div class="info-card dados-lanchonete">
            <div class="lanchonete-imagem">
                <img src="{% static 'dashboard/images/perfil_default.png' %}" alt="Logo Lanchonete">
            </div>
            <div class="lanchonete-info">
                <h2>{{ request.session.user_profile.nome_lanchonete|default:"Nome Lanchonete" }}</h2>
                <p class="categoria">{{ request.session.user_profile.description|default:"Categoria" }}</p>
                <p class="endereco">{{ request.session.user_profile.polo|default:"Endereço" }}</p> {# Ajuste conforme o campo correto do endereço/polo #}
            </div>
            <div class="editar-icon" onclick="window.location.href='{% url 'dashboard:configuracoes' %}'"> {# Link para configurações #}
                <img src="{% static 'dashboard/images/icone_edicao.png' %}" alt="Editar">
            </div>
        </div>

        <div class="info-card horario-funcionamento">
            <h3>Horário de funcionamento</h3>
            <div class="dias-semana">
                <div class="dia-item">
                    <p class="dia-nome">Seg</p>
                    <div class="horario-box">
                        <span>18:00 - 23:00</span>
                    </div>
                </div>
                <div class="dia-item">
                    <p class="dia-nome">Ter</p>
                    <div class="horario-box">
                        <span>18:00 - 23:00</span>
                    </div>
                </div>
                <div class="dia-item">
                    <p class="dia-nome">Qua</p>
                    <div class="horario-box">
                        <span>18:00 - 23:00</span>
                    </div>
                </div>
                <div class="dia-item">
                    <p class="dia-nome">Qui</p>
                    <div class="horario-box">
                        <span>18:00 - 23:00</span>
                    </div>
                </div>
                <div class="dia-item">
                    <p class="dia-nome">Sex</p>
                    <div class="horario-box">
                        <span>18:00 - 23:00</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <section class="desempenho-diario">
        <h2>Desempenho diário</h2>
        <div class="metricas-container">
            <div class="metrica">
                <h3>Pedidos recebidos hoje</h3>
                <p class="valor">15</p> {# Exemplo, substituir por dados reais #}
            </div>
            <div class="separador"></div>
            <div class="metrica">
                <h3>Total em vendas</h3>
                <p class="valor">R$ 812,50</p> {# Exemplo, substituir por dados reais #}
            </div>
            <div class="separador"></div>
            <div class="metrica">
                <h3>Avaliação média</h3>
                <div class="avaliacao-container">
                    <img src="{% static 'dashboard/images/icone_estrela_hd.png' %}" alt="Avaliação" class="estrela-icon-hd">
                    <p class="valor">4,7</p> 
                <p class="total-avaliacoes">(360 avaliações)</p> 
            </div>
        </div>
    </section>

    <section class="ultimos-pedidos">
        <h2>Últimos pedidos realizados</h2>
        <div class="tabela-pedidos">
            <div class="cabecalho-tabela">
                <span class="col-status">Status</span>
                <span class="col-numero">Número pedido</span>
                <span class="col-valor">Valor</span>
                <span class="col-data">Data</span>
                <span class="col-acao">Detalhes</span>
            </div>
            <div class="linha-pedido">
                <div class="col-status">
                    <div class="status-indicator em-andamento"></div>
                    <span>Em andamento</span>
                </div>
                <div class="col-numero">#1200</div>
                <div class="col-valor">R$ 20,00</div>
                <div class="col-data">24/04/2025</div>
                <div class="col-acao">
                    <a href="#" class="ver-detalhes">Ver detalhes</a>
                </div>
            </div>
             <div class="linha-pedido">
                <div class="col-status">
                    <div class="status-indicator concluido"></div>
                    <span>Pedido concluído</span>
                </div>
                <div class="col-numero">#1198</div>
                <div class="col-valor">R$ 20,00</div>
                <div class="col-data">24/04/2025</div>
                <div class="col-acao">
                    <a href="#" class="ver-detalhes">Ver detalhes</a>
                </div>
            </div>
        </div>

        <button class="btn-ver-pedidos" onclick="window.location.href='{% url 'dashboard:pedidos' %}'">Ver Pedidos</button>
    </section>

    <div id="planoModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Alteração de Plano</h2>
                <span class="modal-close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="modal-icon">
                    <img src="{% static 'dashboard/images/icone_info.png' %}" alt="Informação">
                </div>
                <div class="modal-message">
                    <h3 id="modalTitle">Seu plano foi atualizado</h3>
                    <p id="modalMessage">Seu período trial expirou. Seu plano foi alterado para Basic. Agora há uma taxa de 7% por venda.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button id="modalConfirm" class="modal-btn confirm">Entendi</button>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script src="{% static 'dashboard/js/inicio.js' %}"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        setTimeout(() => {
            if (typeof checkTrialExpiration === 'function') {
                checkTrialExpiration();
            } else {
                console.error("Função checkTrialExpiration não encontrada em inicio.js");
            }
        }, 2000); 
    });
    </script>
{% endblock %}